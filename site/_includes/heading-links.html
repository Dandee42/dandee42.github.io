{% assign trans = site.data[site.active_lang] %}

<script defer>
document.addEventListener("DOMContentLoaded", function() {
  const headings = document.querySelectorAll("h2, h3, h4");

  headings.forEach(heading => {
    if (heading.id) {
      const link = document.createElement("a");
      link.href = `#${heading.id}`;
      link.className = "heading-link";
      link.innerHTML = `<img src="/assets/files/images/link-45deg.svg" alt="Odkaz na nadpis" width="16" height="16">`;

      link.addEventListener("click", function(e) {
        e.preventDefault();
        const url = window.location.origin + window.location.pathname + `#${heading.id}`;
        navigator.clipboard.writeText(url).then(() => {
          showCopyMessage("{{ trans.general.copyLink }}");
        });
      });

      heading.appendChild(link);
    }
  });

  function showCopyMessage(message) {
    const msg = document.createElement("div");
    msg.textContent = message;
    msg.style.position = "fixed";
    msg.style.bottom = "20px";
    msg.style.right = "20px";
    msg.style.backgroundColor = "#333";
    msg.style.color = "#fff";
    msg.style.padding = "10px 15px";
    msg.style.borderRadius = "5px";
    msg.style.boxShadow = "0 2px 6px rgba(0,0,0,0.3)";
    msg.style.zIndex = 1000;
    msg.style.opacity = 0;
    msg.style.transition = "opacity 0.3s";

    document.body.appendChild(msg);

    requestAnimationFrame(() => {
      msg.style.opacity = 1;
    });

    setTimeout(() => {
      msg.style.opacity = 0;
      msg.addEventListener("transitionend", () => msg.remove());
    }, 2000);
  }
});
</script>